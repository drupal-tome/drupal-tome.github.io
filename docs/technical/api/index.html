<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
<link rel="canonical" href="https://tome.fyi/docs/technical/api" />
<meta name="description" content="This document covers different APIs that Tome provides." />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="This document covers different APIs that Tome provides." />
<meta name="twitter:title" content="API reference" />
<meta name="twitter:creator" content="@DrupalSAM" />
<meta name="twitter:creator:id" content="@DrupalSAM" />
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="/themes/custom/tomefyi/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="prev" href="/docs/technical" />
<link rel="up" href="/docs/technical" />
<link rel="next" href="/docs/technical/exporter" />

    <title>API reference | Tome</title>
    <link rel="stylesheet" media="all" href="/sites/default/files/css/css_1EkIbkGg3gp-voCDfRqzdJayimxX8z_h7S3w2GWqiJk.css" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_pmAdrN__qVd_mE_lgdCDknMhhgAeEcYW2MILb4K_K08.css" />
<link rel="stylesheet" media="all" href="//fonts.googleapis.com/css?family=Montserrat:900i|Rubik" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_bxU15wLegZoqaK-j4Y7tWjk-VWrIO1821OJn7glJbHY.css" />

    
  </head>
  <body class="path-node page-node-type-book">
        <a href="#main-content" class="visually-hidden focusable skip-link">
      Skip to main content
    </a>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    <div class="page page-node-book">

      <header>
        <div class="region region-header">
    <div id="block-headermenu" class="block block-block-content block-block-content5e7498fd-45bc-4b54-a65d-f0f091d2096e">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><div class="header-menu">
<p><a href="https://drupal.org/project/tome">Source</a>&nbsp;• <a href="https://github.com/drupal-tome">Github</a> • <a href="/docs">Documentation</a>&nbsp;• <a href="https://bookish-drupal.netlify.app/">Demo</a></p>
</div>
</div>
      
  </div>
<div id="block-documentationtitle" class="block block-block-content block-block-content2db80bdd-cd46-41d9-b7b3-410644d9177f">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><div class="documentation-title">
<h1><a href="/">Tome</a></h1>
</div>
</div>
      
  </div>

  </div>

    </header>
  
  <main role="main">
    <a id="main-content" tabindex="-1"></a>

          <aside class="sidebar" role="complementary">
          <div class="region region-sidebar">
    <div id="block-expandedbooknavigation" class="block block-tfyi-book block-expanded-book-navigation">
  
    
        <nav id="book-block-menu-1" class="book-block-menu" role="navigation" aria-label="Book outline for Documentation">
    
              <a class="burger" href="#">&#9776; Navigation</a>
      <ul  class="menu burger-menu">
                    <li class="menu-item menu-item--expanded">
        <a href="/docs" hreflang="en">Documentation</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/getting-started" hreflang="en">Getting started</a>
              </li>
                <li class="menu-item">
        <a href="/docs/installing-existing-site" hreflang="en">Installing to an existing site</a>
              </li>
                <li class="menu-item">
        <a href="/node/23" hreflang="en">Upgrading module/core versions</a>
              </li>
                <li class="menu-item">
        <a href="/docs/use-cases" hreflang="en">Use cases</a>
              </li>
                <li class="menu-item">
        <a href="/docs/using-the-command-line" hreflang="en">Using the command line</a>
              </li>
                <li class="menu-item">
        <a href="/docs/module-compatibility" hreflang="en">Module compatibility</a>
              </li>
                <li class="menu-item">
        <a href="/docs/multilingual" hreflang="en">Multilingual</a>
              </li>
                <li class="menu-item menu-item--expanded">
        <a href="/docs/technical" hreflang="en">Technical documentation</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/technical/api" hreflang="en">API reference</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/exporter" hreflang="en">Exporting</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/importer" hreflang="en">Importing</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/static" hreflang="en">Static site generation</a>
              </li>
                <li class="menu-item">
        <a href="/docs/site-settings" hreflang="en">Site specific settings</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/docker" hreflang="en">Docker</a>
              </li>
        </ul>
  
              </li>
                <li class="menu-item menu-item--expanded">
        <a href="/docs/hosting" hreflang="en">Hosting guides</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/hosting/github-pages" hreflang="en">Github pages</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/gitpod" hreflang="en">Gitpod</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/netlify" hreflang="en">Netlify</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/render" hreflang="en">Render</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/hosted-drupal-netlify" hreflang="en">Hosted Drupal + Netlify</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/hosted-drupal-rewrites" hreflang="en">Hosted Drupal + Rewrites</a>
              </li>
        </ul>
  
              </li>
                <li class="menu-item">
        <a href="/docs/sub-modules" hreflang="en">Using Tome Static and Tome Sync</a>
              </li>
                <li class="menu-item">
        <a href="/docs/faq" hreflang="en">FAQ</a>
              </li>
        </ul>
  
              </li>
        </ul>
  


  </nav>

  </div>

  </div>

      </aside>
    
    <div class="content">
        <div class="region region-content">
    <div data-drupal-messages-fallback class="hidden"></div><div id="block-tomefyi-page-title" class="block block-core block-page-title-block">
  
    
      
  <h1 class="page-title"><span class="field field--name-title field--type-string field--label-hidden">API reference</span>
</h1>


  </div>
<div id="block-mainpagecontent" class="block block-system block-system-main-block">
  
    
      
<article role="article" class="node node--type-book node--view-mode-full">

  
    

  
  <div class="node__content">
    
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p>This document covers different APIs that Tome provides.</p>

<h2>Events</h2>

<ul>
	<li><em>\Drupal\tome_static\Event\TomeStaticEvents::COLLECT_PATHS (<a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_static/src/EventSubscriber/EntityPathSubscriber.php">example</a>)</em><br />
	This event is fired when collecting paths for the static generator. It can be used to provide or modify paths, which is useful if there are specific paths you want to be included that Tome may have missed. If you want to exclude a path, consider setting the <a href="/docs/site-settings/">"tome_static_path_exclude" setting.</a></li>
	<li><em>\Drupal\tome_static\Event\TomeStaticEvents::PATH_PLACEHOLDER (<a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_static/src/EventSubscriber/EntityPathSubscriber.php">example</a>)</em><br />
	This event is&nbsp;fired when replacing a path placeholder. This is useful if you implemented the "TomeStaticEvents::COLLECT_PATHS" event and wanted to provide an entity specific route that is expensive to load, so instead you provided a placeholder. This is how Tome can process so many entity paths without running out of memory.</li>
	<li><em>\Drupal\tome_static\Event\TomeStaticEvents::REQUEST_PREPARE (<a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_static/src/EventSubscriber/PageCacheRequestPrepareSubscriber.php">example</a>)</em><br />
	This event is fired&nbsp;when preparing for a new request. Drupal isn't really designed to handle multiple requests in one bootstrap, but Tome tries to get around this by resetting the global and container state to avoid any request specific behavior. This would be useful if you needed to reset a&nbsp;request specific cache for your own services.</li>
	<li><em>\Drupal\tome_static\Event\TomeStaticEvents::MODIFY_HTML (<a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_static/src/EventSubscriber/PagerPathSubscriber.php">example</a>)</em><br />
	This event is fired when finding paths related to an HTML document. You can use it to make any modifications to HTML, ideally related to finding paths to transform and add to the list of paths to invoke. Specifically, this is used for transforming links that include query parameters to paths that will work with the static site (i.e. ?page=1 -&gt; /page/1).</li>
	<li><em>\Drupal\tome_static\Event\TomeStaticEvents::MODIFY_DESTINATION (<a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_static/src/EventSubscriber/PagerPathSubscriber.php">example</a>)</em><br />
	This event is fired when determining the destination for a path. If you've transformed a path in HTML with the "TomeStaticEvents::MODIFY_HTML" event, you'll also want to make sure the destination for that path matches your modifications. This event is fired before "index.html" is appended to paths without an extension.</li>
	<li><em>\Drupal\tome_static\Event\TomeStaticEvents::FILE_SAVED</em><br />
	This event is fired anytime a file is saved by the static generator, including static assets that are copied from the filesystem like images or stylesheets. This is the only unused event in Tome, and exists to enable other modules to sync the static export to an external service when they're saved.</li>
	<li><em>\Drupal\tome_sync\Event\TomeSyncEvents::EXPORT_CONTENT (<a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_sync/src/EventSubscriber/BookEventSubscriber.php">example</a>)</em><br />
	This event is fired&nbsp;after a single content entity is exported. This <strong>should not be be used</strong> to modify the JSON&nbsp;output of the exporter (use normalizers for that), but can be used to export assets &nbsp;related to the content.</li>
	<li><em>\Drupal\tome_sync\Event\TomeSyncEvents::DELETE_CONTENT (<a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_sync/src/EventSubscriber/ContentHasherEventSubscriber.php">example</a>)</em><br />
	This event is fired after&nbsp;a single content entity is deleted.</li>
	<li><em>\Drupal\tome_sync\Event\TomeSyncEvents::IMPORT_CONTENT (<a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_sync/src/EventSubscriber/ContentHasherEventSubscriber.php">example</a>)</em><br />
	This event is fired&nbsp;after a single content entity is imported (created or updated).</li>
	<li><em>\Drupal\tome_sync\Event\TomeSyncEvents::EXPORT_ALL (<a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_sync/src/EventSubscriber/BookEventSubscriber.php">example</a>)</em><br />
	This event is fired after&nbsp;the entire export process is complete.</li>
	<li><em>\Drupal\tome_sync\Event\TomeSyncEvents::IMPORT_ALL (<a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_sync/src/EventSubscriber/BookEventSubscriber.php">example</a>)</em><br />
	This event is fired after the entire import process is complete. Note that this event is also fired after partial imports are complete.</li>
</ul>

<h2>Using the tome_static.generator service</h2>

<p>Beyond what's documented in the <a href="https://git.drupalcode.org/project/tome/blob/8.x-1.x/modules/tome_static/src/StaticGeneratorInterface.php">static generator's interface</a>, it can be hard to know how to accurately generate static pages manually. Here's a documented code snippet that goes over almost everything the static command and form does:</p>

<pre>
<code class="language-php">&lt;?php

/** @var \Drupal\tome_static\StaticGeneratorInterface $static */
$static = \Drupal::service('tome_static.generator');

/** @var \Drupal\tome_static\RequestPreparer $request_preparer */
$request_preparer = \Drupal::service('tome_static.request_preparer');

// Prepare for a new request. This is necessary so that static caches in Drupal
// can be reset between multiple requests in one bootstrap.
$request_preparer-&gt;prepareForRequest();

// Request an arbitrary path. "$invoke_paths" at this point is anything that
// needs to be copied (an existing file) or requested (an image derivative,
// other paths, etc.)
$invoke_paths = $static-&gt;requestPath('/foo');

// Export paths will try to copy or remove as many paths as possible without
// making a new internal request.
$invoke_paths = $static-&gt;exportPaths($invoke_paths);

// The remaining invoke paths need to be handled in new requests.
foreach ($invoke_paths as $path) {
  // Since we are only trying to export one path, restrict new requests to
  // paths with extensions, which are probably RSS feeds and image derivatives.
  if (pathinfo($path, PATHINFO_EXTENSION)) {
    $request_preparer-&gt;prepareForRequest();
    // This could return more paths, but we're ignoring that for simplicity.
    $static-&gt;requestPath($path);
  }
}
</code></pre>

<p>&nbsp;</p>
</div>
      
  <nav id="book-navigation-1" class="book-navigation" role="navigation" aria-labelledby="book-label-1">
    
          <h2 class="visually-hidden" id="book-label-1">Book traversal links for API reference</h2>
      <ul class="book-pager">
              <li class="book-pager__item book-pager__item--previous">
          <a href="/docs/technical" rel="prev" title="Go to previous page"><b>‹</b> Technical documentation</a>
        </li>
                    <li class="book-pager__item book-pager__item--center">
          <a href="/docs/technical" title="Go to parent page">Up</a>
        </li>
                    <li class="book-pager__item book-pager__item--next">
          <a href="/docs/technical/exporter" rel="next" title="Go to next page">Exporting <b>›</b></a>
        </li>
          </ul>
      </nav>

  </div>

</article>

  </div>

  </div>

    </div>
  </main>

  <footer>
      <div class="region region-footer">
    <div id="block-footerblock" class="block block-block-content block-block-content41a379f1-9578-43d6-9b62-977bfe857232">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p class="text-align-center"><a href="https://github.com/drupal-tome">Github</a>&nbsp;- <a href="https://www.drupal.org/project/tome">Drupal.org</a> - <a href="https://twitter.com/mortensonsam">Twitter</a>&nbsp;- <a href="https://drupalslack.herokuapp.com">Slack (#tome)</a></p>

<p class="text-align-center">Tome is in development and likely has some bugs. Please be patient and&nbsp;respectful when reporting issues!</p>

<p class="text-align-center">This site is built with Tome! <a href="https://github.com/drupal-tome/drupal-tome.github.io">Check it out and build it locally from Github</a>.</p>
</div>
      
  </div>

  </div>

  </footer>

</div>

  </div>

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/18","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"user":{"uid":0,"permissionsHash":"441fcc92e601820560c4fdbdef39bc2131ec7bd8c123c72f7ad596854270b3da"}}</script>
<script src="/sites/default/files/js/js_Kbbh7yC5kf-weSWDxBsiC6YIXh4PBazkCj3Jk3WBdMo.js"></script>

  </body>
</html>
