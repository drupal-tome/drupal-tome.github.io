<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
<link rel="canonical" href="https://tome.fyi/docs/using-the-command-line" />
<meta name="description" content="Learn about Tome&#039;s various command line tools." />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="Learn about Tome&#039;s various command line tools." />
<meta name="twitter:title" content="Using the command line" />
<meta name="twitter:creator" content="@DrupalSAM" />
<meta name="twitter:creator:id" content="@DrupalSAM" />
<meta name="Generator" content="Drupal 9 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="/themes/custom/tomefyi/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="prev" href="/docs/use-cases" />
<link rel="up" href="/docs" />
<link rel="next" href="/docs/module-compatibility" />

    <title>Using the command line | Tome</title>
    <link rel="stylesheet" media="all" href="/sites/default/files/css/css_1EkIbkGg3gp-voCDfRqzdJayimxX8z_h7S3w2GWqiJk.css" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_pmAdrN__qVd_mE_lgdCDknMhhgAeEcYW2MILb4K_K08.css" />
<link rel="stylesheet" media="all" href="//fonts.googleapis.com/css?family=Montserrat:900i|Rubik" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_bxU15wLegZoqaK-j4Y7tWjk-VWrIO1821OJn7glJbHY.css" />

    
  </head>
  <body class="path-node page-node-type-book">
        <a href="#main-content" class="visually-hidden focusable skip-link">
      Skip to main content
    </a>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    <div class="page page-node-book">

      <header>
        <div class="region region-header">
    <div id="block-headermenu" class="block block-block-content block-block-content5e7498fd-45bc-4b54-a65d-f0f091d2096e">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><div class="header-menu">
<p><a href="https://drupal.org/project/tome">Source</a>&nbsp;• <a href="https://github.com/drupal-tome">Github</a> • <a href="/docs">Documentation</a></p>
</div>
</div>
      
  </div>
<div id="block-documentationtitle" class="block block-block-content block-block-content2db80bdd-cd46-41d9-b7b3-410644d9177f">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><div class="documentation-title">
<h1><a href="/">Tome</a></h1>
</div>
</div>
      
  </div>

  </div>

    </header>
  
  <main role="main">
    <a id="main-content" tabindex="-1"></a>

          <aside class="sidebar" role="complementary">
          <div class="region region-sidebar">
    <div id="block-expandedbooknavigation" class="block block-tfyi-book block-expanded-book-navigation">
  
    
        <nav id="book-block-menu-1" class="book-block-menu" role="navigation" aria-label="Book outline for Documentation">
    
              <a class="burger" href="#">&#9776; Navigation</a>
      <ul  class="menu burger-menu">
                    <li class="menu-item menu-item--expanded">
        <a href="/docs" hreflang="en">Documentation</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/getting-started" hreflang="en">Getting started</a>
              </li>
                <li class="menu-item">
        <a href="/docs/installing-existing-site" hreflang="en">Installing to an existing site</a>
              </li>
                <li class="menu-item">
        <a href="/node/24" hreflang="en">Upgrading module/core versions</a>
              </li>
                <li class="menu-item">
        <a href="/docs/use-cases" hreflang="en">Use cases</a>
              </li>
                <li class="menu-item">
        <a href="/docs/using-the-command-line" hreflang="en">Using the command line</a>
              </li>
                <li class="menu-item">
        <a href="/docs/module-compatibility" hreflang="en">Module compatibility</a>
              </li>
                <li class="menu-item">
        <a href="/docs/multilingual" hreflang="en">Multilingual</a>
              </li>
                <li class="menu-item menu-item--expanded">
        <a href="/docs/technical" hreflang="en">Technical documentation</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/technical/api" hreflang="en">API reference</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/exporter" hreflang="en">Exporting</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/importer" hreflang="en">Importing</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/static" hreflang="en">Static site generation</a>
              </li>
                <li class="menu-item">
        <a href="/docs/site-settings" hreflang="en">Site specific settings</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/docker" hreflang="en">Docker</a>
              </li>
        </ul>
  
              </li>
                <li class="menu-item menu-item--expanded">
        <a href="/docs/hosting" hreflang="en">Hosting guides</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/hosting/github-pages" hreflang="en">Github pages</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/netlify" hreflang="en">Netlify</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/render" hreflang="en">Render</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/hosted-drupal-netlify" hreflang="en">Hosted Drupal + Netlify</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/hosted-drupal-rewrites" hreflang="en">Hosted Drupal + Rewrites</a>
              </li>
        </ul>
  
              </li>
                <li class="menu-item">
        <a href="/docs/sub-modules" hreflang="en">Using Tome Static and Tome Sync</a>
              </li>
                <li class="menu-item">
        <a href="/docs/faq" hreflang="en">FAQ</a>
              </li>
        </ul>
  
              </li>
        </ul>
  


  </nav>

  </div>

  </div>

      </aside>
    
    <div class="content">
        <div class="region region-content">
    <div data-drupal-messages-fallback class="hidden"></div><div id="block-tomefyi-page-title" class="block block-core block-page-title-block">
  
    
      
  <h1 class="page-title"><span class="field field--name-title field--type-string field--label-hidden">Using the command line</span>
</h1>


  </div>
<div id="block-mainpagecontent" class="block block-system block-system-main-block">
  
    
      
<article role="article" class="node node--type-book node--view-mode-full">

  
    

  
  <div class="node__content">
    
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p>Tome comes with a few Drush commands which export and import content, and generate static HTML.</p>

<h2>tome:export</h2>

<p>The export command will delete and regenerate all your config, content, and files based on what's currently on your local machine. Ideally you would only run this once when you first start using Tome, then from that point on rely on the automatic syncing feature to keep your codebase up to date. That said, if you've automatically done something like a "git reset --hard" locally and lost your changes, a fresh export will save your work.</p>

<h2>tome:import</h2>

<p>The import command should be run after every fresh Drupal install, or otherwise at the start of each local editing session. All your local install's config, content, and files will be replaced. While it is possible to run this command after the site has been installed, for example after a "git pull", it's recommended that you always start with a fresh install.</p>

<h2>tome:import-partial</h2>

<p>The import partial command only imports content and config that has been modified, added, or deleted. If you already have an installed site this command should be all you need as you pull in changes or check out new commits.</p>

<h2>tome:static</h2>

<p>The static command exports static HTML to your export directory, which is usually a root-level "html" folder. On a large site with a lot of paths this can take awhile, so a progress bar is included to keep everyone sane.</p>

<p>If you want to review your static site after running this command, you can pass the "--run-server" option, which will automatically open a local server and browser tab, similar to how "drush runserver" works.</p>

<p>All builds are cached by default. If you have pages that don't quite work with cache, you can set the "tome_static_cache_exclude" option in your settings.php file. See <a href="/docs/site-settings">Site settings</a> for more information.</p>

<h2>tome:preview</h2>

<p>The preview command runs a simple local server that lets you preview your static site.</p>

<h2>tome:clean-files</h2>

<p>The clean-files command looks for files that appear to be unused by any other config or content entity, and prompts the user to delete them. This command exists because Drupal has some issues with old files sticking around after they stop being referenced. Traditionally this has been solved with a mechanism called file usage, but that system isn't super reliable in complex setups. In the future an automatic garbage collection mechanism for files will be built into Tome, but for now you should run this command every now and then to clean up your repository.</p>

<h2>Improving performance</h2>

<p>As sites grow larger and more and more entities are created, these commands will&nbsp;start to slow down pretty quick. To address that, many commands accept a "--process-count" option, which determines the maximum number of processes to invoke while doing a task. The import and export commands include a "--entity-count" option, which determines how many entities each process should process. The static command includes a "--path-count" option, which determines how many paths to export per process.</p>

<p>Every site and local environment is different, so it's up to you to tweak these values to suit your use case. I've found that SQLite has some problems with concurrency, so for import and export it may be best to bump up the entity count option before touching the process count.</p>

<p>Concurrency is going to help out large sites a lot, but there are other things you can do to speed up your local environment. Some options are:</p>

<ul>
	<li>Increase PHP's memory_limit setting in your php.ini file&nbsp;to avoid running out of memory in each process.</li>
	<li>Instead of using SQLite, try using something like MAMP or Acquia's Dev Desktop to run a more traditional stack with MySQL. This can avoid deadlocks and improve performance.</li>
	<li>Use a container for all your development to keep the environment consistent across team members.</li>
	<li>Create a continuous delivery job which automatically generates static HTML on commit.</li>
</ul>

<p>Good luck!</p>
</div>
      
  <nav id="book-navigation-1" class="book-navigation" role="navigation" aria-labelledby="book-label-1">
    
          <h2 class="visually-hidden" id="book-label-1">Book traversal links for Using the command line</h2>
      <ul class="book-pager">
              <li class="book-pager__item book-pager__item--previous">
          <a href="/docs/use-cases" rel="prev" title="Go to previous page"><b>‹</b> Use cases</a>
        </li>
                    <li class="book-pager__item book-pager__item--center">
          <a href="/docs" title="Go to parent page">Up</a>
        </li>
                    <li class="book-pager__item book-pager__item--next">
          <a href="/docs/module-compatibility" rel="next" title="Go to next page">Module compatibility <b>›</b></a>
        </li>
          </ul>
      </nav>

  </div>

</article>

  </div>

  </div>

    </div>
  </main>

  <footer>
      <div class="region region-footer">
    <div id="block-footerblock" class="block block-block-content block-block-content41a379f1-9578-43d6-9b62-977bfe857232">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p class="text-align-center"><a href="https://github.com/drupal-tome">Github</a>&nbsp;- <a href="https://www.drupal.org/project/tome">Drupal.org</a> - <a href="https://twitter.com/DrupalSAM">Twitter</a>&nbsp;- <a href="https://drupalslack.herokuapp.com">Slack (#tome)</a></p>

<p class="text-align-center">Tome is in development and likely has some bugs. Please be patient and&nbsp;respectful when reporting issues!</p>

<p class="text-align-center">This site is built with Tome! <a href="https://github.com/drupal-tome/drupal-tome.github.io">Check it out and build it locally from Github</a>.</p>
</div>
      
  </div>

  </div>

  </footer>

</div>

  </div>

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/4","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"user":{"uid":0,"permissionsHash":"2f50923e6341ecd7be516fe5190455c06e1a4e4779bb54728c99b064f995f54e"}}</script>
<script src="/sites/default/files/js/js_Kbbh7yC5kf-weSWDxBsiC6YIXh4PBazkCj3Jk3WBdMo.js"></script>

  </body>
</html>
